import{c as S,j as e,L as M,e as C,r as i,d as A}from"./index-DwRnVWOH.js";const E=r=>e.jsx("img",{...r,onError:n=>{n.currentTarget.onerror=null,n.currentTarget.src="/fallback.png"}}),F=({products:r})=>{const{addToCart:n,openDrawer:d}=S(),o=a=>{n({_id:a._id,name:a.name,price:a.price,imgSrc:a.imgSrc}),d()};return!r||r.length===0?e.jsx("div",{className:"w-full text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No products found in this category."})}):e.jsx("div",{className:"w-full max-w-7xl mx-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full",children:r.map(a=>e.jsxs("div",{className:"max-w-xs bg-white rounded-xl shadow-md overflow-hidden relative",children:[e.jsxs(M,{to:`/product/${a._id}`,children:[e.jsxs("div",{className:"relative w-full h-40 bg-gray-200 rounded-md",children:[a.imgSrc?e.jsx(E,{src:a.imgSrc,alt:a.name,className:"w-full h-full object-contain bg-white"}):e.jsx("span",{className:"text-gray-500 flex items-center justify-center h-full",children:"No Image"}),a.isNew&&e.jsx("span",{className:"absolute top-2 right-2 bg-black text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Just In"})]}),e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:a.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 px-4 pb-4",children:[e.jsxs("span",{className:"text-lg font-bold text-black",children:["Rp",Number(a.price||0).toLocaleString("id-ID")]}),e.jsx("button",{onClick:()=>o(a),className:"inline-block bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-full px-4 py-1 text-sm font-semibold tracking-wide shadow-md hover:scale-105 transition-transform",children:"Add Cart"})]})]},a._id))})})},P=C(r=>({filters:{sale:!1,gender:"all",ageGroup:"all",price:"none"},setFilter:(n,d)=>r(o=>({filters:{...o.filters,[n]:d}})),toggleFilter:n=>r(d=>({filters:{...d.filters,[n]:!d.filters[n]}}))})),L=()=>e.jsxs("div",{className:"max-w-xs bg-white rounded-xl shadow-md overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-40 bg-gray-200"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 w-1/2"})]})]});function G(){const{filters:r,setFilter:n,toggleFilter:d}=P(),[o,a]=i.useState("All"),[m,y]=i.useState([]),[N,b]=i.useState(!0),[j,w]=i.useState(null),[l,g]=i.useState(1),h=30,u=i.useRef(null);i.useEffect(()=>{(async()=>{try{b(!0);const t=await A.get("/items");y(Array.isArray(t)?t:[])}catch(t){w(t.message||"Failed to fetch products")}finally{b(!1)}})()},[]),i.useMemo(()=>["All",...Array.from(new Set(m.map(s=>s.category).filter(Boolean)))],[m]);const x=i.useMemo(()=>{let s=o==="All"?m:m.filter(t=>t.category===o);return r.sale&&(s=s.filter(t=>(t.price??0)<3e6)),r.gender!=="all"&&(s=s.filter(t=>(t.gender?.toLowerCase()||"")===r.gender)),r.ageGroup!=="all"&&(s=s.filter(t=>(t.ageGroup?.toLowerCase()||"")===r.ageGroup)),r.price==="low-high"?s=[...s].sort((t,f)=>(t.price??0)-(f.price??0)):r.price==="high-low"&&(s=[...s].sort((t,f)=>(f.price??0)-(t.price??0))),s},[m,o,r]),c=i.useMemo(()=>Math.max(1,Math.ceil(x.length/h)),[x.length]),v=i.useMemo(()=>{const s=(l-1)*h;return x.slice(s,s+h)},[x,l]),k=i.useMemo(()=>{const s=[];if(c<=7)for(let t=1;t<=c;t++)s.push(t);else{s.push(1),l>4&&s.push("...");const t=Math.max(2,l-1),f=Math.min(c-1,l+1);for(let p=t;p<=f;p++)s.push(p);l<c-3&&s.push("..."),s.push(c)}return s},[l,c]);return i.useEffect(()=>{u.current&&u.current.scrollTo({top:0,behavior:"smooth"})},[l,o,r]),i.useEffect(()=>{g(1)},[o,r]),i.useEffect(()=>{l>c&&g(c)},[c,l]),e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm flex-shrink-0",children:e.jsx("div",{className:"container mx-auto px-4 py-4",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Store"})})}),e.jsx("div",{className:"container mx-auto px-4 py-6 flex gap-6",children:e.jsx("main",{ref:u,className:"flex-1 overflow-y-auto pr-2",children:N?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:6}).map((s,t)=>e.jsx(L,{},t))}):j?e.jsx("p",{className:"text-center py-10 text-red-500",children:j}):e.jsxs(e.Fragment,{children:[e.jsx(F,{products:v}),e.jsx("div",{className:"sticky bottom-0 mt-6 bg-gray-50/90 backdrop-blur border-t",children:e.jsxs("div",{className:"py-3 flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-600 px-1",children:["Menampilkan ",(l-1)*h+1,"–",Math.min(l*h,x.length)," dari ",x.length," produk"]}),e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("button",{onClick:()=>g(s=>Math.max(1,s-1)),disabled:l===1,className:"px-3 py-1.5 rounded border bg-white disabled:opacity-50",children:"‹ Prev"}),k.map((s,t)=>s==="..."?e.jsx("span",{className:"px-2 select-none",children:"…"},`dots-${t}`):e.jsx("button",{onClick:()=>g(s),className:`px-3 py-1.5 rounded border ${s===l?"bg-black text-white border-black":"bg-white hover:bg-gray-100"}`,"aria-current":s===l?"page":void 0,children:s},s)),e.jsx("button",{onClick:()=>g(s=>Math.min(c,s+1)),disabled:l===c,className:"px-3 py-1.5 rounded border bg-white disabled:opacity-50",children:"Next ›"})]})]})})]})})})]})}export{G as default};
