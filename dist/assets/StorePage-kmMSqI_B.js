import{a as I,j as e,L as D,e as _,r,b as O}from"./index-CJCUCUOf.js";const q=a=>e.jsx("img",{...a,onError:i=>{i.currentTarget.onerror=null,i.currentTarget.src="/fallback.png"}}),z=({products:a})=>{const{addToCart:i,openDrawer:h}=I(),o=t=>{i({_id:t._id,name:t.name,price:t.price,imgSrc:t.imgSrc}),h()};return!a||a.length===0?e.jsx("div",{className:"w-full text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No products found in this category."})}):e.jsx("div",{className:"w-full max-w-7xl mx-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full",children:a.map(t=>e.jsxs("div",{className:"max-w-xs bg-white rounded-xl shadow-md overflow-hidden relative",children:[e.jsxs(D,{to:`/product/${t._id}`,children:[e.jsxs("div",{className:"relative w-full h-40 bg-gray-200 rounded-md",children:[t.imgSrc?e.jsx(q,{src:t.imgSrc,alt:t.name,className:"w-full h-full object-contain bg-white"}):e.jsx("span",{className:"text-gray-500 flex items-center justify-center h-full",children:"No Image"}),t.isNew&&e.jsx("span",{className:"absolute top-2 right-2 bg-black text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Just In"})]}),e.jsxs("div",{className:"p-4 flex flex-col",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-3 px-4 pb-4",children:[e.jsxs("span",{className:"text-lg font-bold text-black",children:["Rp",Number(t.price||0).toLocaleString("id-ID")]}),e.jsx("button",{onClick:()=>o(t),className:"inline-block bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-full px-4 py-1 text-sm font-semibold tracking-wide shadow-md hover:scale-105 transition-transform",children:"Add Cart"})]})]},t._id))})})},K=_(a=>({filters:{sale:!1,gender:"all",ageGroup:"all",price:"none"},setFilter:(i,h)=>a(o=>({filters:{...o.filters,[i]:h}})),toggleFilter:i=>a(h=>({filters:{...h.filters,[i]:!h.filters[i]}}))})),U=()=>e.jsxs("div",{className:"max-w-xs bg-white rounded-xl shadow-md overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-40 bg-gray-200"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 w-1/2"})]})]});function V(a,i=400){const[h,o]=r.useState(a);return r.useEffect(()=>{const t=setTimeout(()=>o(a),i);return()=>clearTimeout(t)},[a,i]),h}function H(){const{filters:a,setFilter:i,toggleFilter:h}=K(),[o,t]=r.useState("All"),[u,E]=r.useState([]),[N,w]=r.useState(!0),[k,C]=r.useState(null),[n,m]=r.useState(1),g=30,j=r.useRef(null),[R,y]=r.useState(!1),[S,M]=r.useState(""),p=V(S,450),[b,A]=r.useState(!1),v=r.useCallback(async()=>{try{w(!0),C(null);const s=await O.get("/items");E(Array.isArray(s)?s:[])}catch(s){C(s?.payload?.error||s?.message||"Failed to fetch products")}finally{w(!1)}},[]);r.useEffect(()=>{v()},[v]);const T=r.useMemo(()=>["All",...Array.from(new Set(u.map(s=>s.category).filter(Boolean)))],[u]),x=r.useMemo(()=>{let s=o==="All"?u:u.filter(l=>(l.category||"")===o);if(p.trim()){const l=p.toLowerCase();s=s.filter(d=>{const f=(d.name||"").toLowerCase(),$=(d.description||"").toLowerCase();return f.includes(l)||$.includes(l)})}return a.sale&&(s=s.filter(l=>(l.price??0)<3e6)),a.gender!=="all"&&(s=s.filter(l=>(l.gender?.toLowerCase()||"")===a.gender)),a.ageGroup!=="all"&&(s=s.filter(l=>(l.ageGroup?.toLowerCase()||"")===a.ageGroup)),b&&(s=s.filter(l=>(l.stock??1)>0)),a.price==="low-high"?s=[...s].sort((l,d)=>(l.price??0)-(d.price??0)):a.price==="high-low"&&(s=[...s].sort((l,d)=>(d.price??0)-(l.price??0))),s},[u,o,a,p,b]),c=r.useMemo(()=>Math.max(1,Math.ceil(x.length/g)),[x.length]),G=r.useMemo(()=>{const s=(n-1)*g;return x.slice(s,s+g)},[x,n]),P=r.useMemo(()=>{const s=[];if(c<=7)for(let l=1;l<=c;l++)s.push(l);else{s.push(1),n>4&&s.push("...");const l=Math.max(2,n-1),d=Math.min(c-1,n+1);for(let f=l;f<=d;f++)s.push(f);n<c-3&&s.push("..."),s.push(c)}return s},[n,c]);r.useEffect(()=>{j.current&&j.current.scrollTo({top:0,behavior:"smooth"})},[n,o,a,p]),r.useEffect(()=>{m(1)},[o,a,p,b]),r.useEffect(()=>{n>c&&m(c)},[c,n]),r.useEffect(()=>{const s=l=>{l.key==="ArrowLeft"&&m(d=>Math.max(1,d-1)),l.key==="ArrowRight"&&m(d=>Math.min(c,d+1))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[c]);const F=()=>{i("gender","all"),i("ageGroup","all"),i("price","none"),a.sale&&h("sale"),A(!1),t("All"),M("")},L=e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 max-h-[80vh] overflow-y-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-semibold text-lg mb-3",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(s=>{const l=o===s;return e.jsx("button",{className:`px-3 py-1.5 rounded-full border transition-colors ${l?"bg-black text-white border-black":"bg-white hover:bg-gray-100"}`,onClick:()=>t(s),children:s},s)})})]}),e.jsx("div",{className:"h-px bg-gray-100"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1",children:"Gender"}),e.jsxs("select",{value:a.gender,onChange:s=>i("gender",s.target.value),className:"w-full border rounded px-2 py-1",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"unisex",children:"Unisex"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1",children:"Age Group"}),e.jsxs("select",{value:a.ageGroup,onChange:s=>i("ageGroup",s.target.value),className:"w-full border rounded px-2 py-1",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"adult",children:"Adult"}),e.jsx("option",{value:"child",children:"Child"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium mb-1",children:"Urutkan Harga"}),e.jsxs("select",{value:a.price,onChange:s=>i("price",s.target.value),className:"w-full border rounded px-2 py-1",children:[e.jsx("option",{value:"none",children:"Default"}),e.jsx("option",{value:"low-high",children:"Rendah → Tinggi"}),e.jsx("option",{value:"high-low",children:"Tinggi → Rendah"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Sale & Offers"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:a.sale,onChange:()=>h("sale")}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-black relative",children:e.jsx("div",{className:`absolute top-[2px] left-[2px] h-5 w-5 bg-white border border-gray-300 rounded-full transition-all ${a.sale?"translate-x-5":""}`})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Ready Stock"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:b,onChange:()=>A(s=>!s)}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-checked:bg-black relative",children:e.jsx("div",{className:`absolute top-[2px] left-[2px] h-5 w-5 bg-white border border-gray-300 rounded-full transition-all ${b?"translate-x-5":""}`})})]})]}),e.jsx("button",{onClick:F,className:"w-full mt-2 px-3 py-2 rounded-lg border bg-white hover:bg-gray-100",children:"Reset Semua Filter"})]})]});return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm flex-shrink-0",children:e.jsxs("div",{className:"container mx-auto px-4 py-4 flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Store"}),e.jsxs("div",{className:"ml-auto flex-1 max-w-xl",children:[e.jsx("label",{className:"sr-only",htmlFor:"search",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"search",value:S,onChange:s=>M(s.target.value),placeholder:"Cari produk, model, brand…",className:"w-full border rounded-lg px-3 py-2 pr-10"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:"⌘K"})]})]}),e.jsx("button",{onClick:()=>y(!0),className:"md:hidden px-3 py-2 rounded-lg border bg-white hover:bg-gray-100",children:"Filter"})]})}),e.jsxs("div",{className:"container mx-auto px-4 py-6 flex gap-6",children:[e.jsx("aside",{className:"hidden md:block w-72 flex-shrink-0",children:e.jsx("div",{className:"sticky top-28",children:L})}),e.jsxs("main",{ref:j,className:"flex-1 overflow-y-auto pr-2",children:[e.jsx("div",{className:"mb-4 text-sm text-gray-600",children:N?"Memuat produk…":`${x.length} produk ditemukan`}),N?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:9}).map((s,l)=>e.jsx(U,{},l))}):k?e.jsxs("div",{className:"py-10 text-center space-y-3",children:[e.jsx("p",{className:"text-red-500",children:k}),e.jsx("button",{onClick:v,className:"px-4 py-2 rounded-lg border bg-white hover:bg-gray-100",children:"Coba lagi"})]}):x.length===0?e.jsxs("div",{className:"py-16 text-center space-y-3",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Tidak ada produk cocok"}),e.jsx("p",{className:"text-gray-500",children:"Coba hapus beberapa filter atau ubah kata kunci pencarian."}),e.jsx("button",{onClick:F,className:"px-4 py-2 rounded-lg border bg-white hover:bg-gray-100",children:"Reset filter"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{products:G}),e.jsx("div",{className:"sticky bottom-0 mt-6 bg-gray-50/90 backdrop-blur border-t",children:e.jsxs("div",{className:"py-3 flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-600 px-1",children:["Menampilkan ",(n-1)*g+1,"–",Math.min(n*g,x.length)," dari ",x.length," produk"]}),e.jsxs("div",{className:"flex items-center gap-2 px-1",children:[e.jsx("button",{onClick:()=>m(s=>Math.max(1,s-1)),disabled:n===1,className:"px-3 py-1.5 rounded border bg-white disabled:opacity-50",children:"‹ Prev"}),P.map((s,l)=>s==="..."?e.jsx("span",{className:"px-2 select-none",children:"…"},`dots-${l}`):e.jsx("button",{onClick:()=>m(s),className:`px-3 py-1.5 rounded border ${s===n?"bg-black text-white border-black":"bg-white hover:bg-gray-100"}`,"aria-current":s===n?"page":void 0,children:s},s)),e.jsx("button",{onClick:()=>m(s=>Math.min(c,s+1)),disabled:n===c,className:"px-3 py-1.5 rounded border bg-white disabled:opacity-50",children:"Next ›"})]})]})})]})]})]}),R&&e.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40",onClick:()=>y(!1)}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-11/12 max-w-sm bg-white shadow-xl p-4 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Filter"}),e.jsx("button",{onClick:()=>y(!1),className:"px-3 py-1.5 rounded-lg border bg-white hover:bg-gray-100",children:"Tutup"})]}),L]})]})]})}export{H as default};
